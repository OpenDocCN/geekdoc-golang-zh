# 前言

![](img/chapterart.png)

随着互联网的到来，对网络工程师和开发者的需求日益增加。如今，个人电脑、平板、手机、电视、手表、游戏系统、车辆、常见家居用品甚至门铃都可以通过互联网进行通信。网络编程使这一切成为可能。而*安全*的网络编程则使其值得信赖，促使越来越多的人采纳这些服务。本书将教你如何使用 Go 的异步功能编写现代网络软件。

Google 于 2007 年创建了 Go 编程语言，旨在提高开发者在处理大型代码库时的生产力。自那时以来，Go 已经赢得了作为一种快速、高效、安全的语言的声誉，被全球一些最大型公司用于软件的开发和部署。Go 易于学习，拥有丰富的标准库，特别适合利用多核和网络系统的优势。

本书详细介绍了网络编程的基础，重点是安全性。你将学习套接字级编程，包括 TCP、UDP 和 Unix 套接字，使用 HTTPS 和 HTTP/2 等应用层协议进行交互，使用 Gob、JSON、XML 和协议缓冲等格式进行数据序列化，为你的网络服务执行身份验证和授权，创建流和异步数据传输，编写 gRPC 微服务，执行结构化日志记录和仪表化，并将应用部署到云端。

在我们完成这次学习之旅后，你应该能够熟练使用 Go 语言及其标准库，并利用流行的第三方包设计和实现安全的网络应用和微服务。每一章都会使用最佳实践，并包含一些智慧的点滴，帮助你避免潜在的陷阱。

## 本书的读者群体

如果你想学习如何使用标准协议在网络上安全地共享数据，同时编写稳定、安全和高效的 Go 代码，那么这本书适合你。

目标读者是那些关注安全的开发者或系统管理员，他们希望深入学习网络编程，并且已经具备 Go 和 Go 模块支持的基础知识。尽管如此，前几章会介绍基本的网络概念，因此网络编程的新人也欢迎阅读。

在设计和开发网络应用时，跟上现代协议、标准和最佳实践可能会非常困难。这就是为什么在本书的学习过程中，你将承担越来越多的责任。同时，你也将接触到一些工具和技术，帮助你管理工作负载。

## 安装 Go

要跟随本书中的代码进行学习，请安装最新稳定版本的 Go，可以通过 [`golang.org/`](https://golang.org/) 进行下载。对于本书中的大多数程序，你至少需要 Go 1.12。然而，本书中的某些程序仅与 Go 1.14 或更新版本兼容。书中会指出这些代码的使用。

请记住，你操作系统的包管理器中提供的 Go 版本可能比最新的稳定版本要滞后。

## 推荐的开发环境

本书中的代码示例大多数与 Windows 10、Windows 子系统 Linux、macOS Catalina 以及现代 Linux 发行版（如 Ubuntu 20.04、Fedora 32 和 Manjaro 20.1）兼容。书中会指出任何与这些操作系统不兼容的代码示例。

一些用于测试网络服务的命令行工具，例如`curl`或`nmap`，可能不是操作系统标准安装的一部分。你可能需要通过使用与你的操作系统兼容的包管理器来安装这些命令行工具，例如 macOS 的[Homebrew](https://brew.sh/)或 Windows 10 的[Chocolatey](https://chocolatey.org/)。现代 Linux 操作系统的包管理器应包含更新的二进制文件，允许你执行代码示例。

## 本书内容

本书分为四个部分。第一部分将教你一些在开始编写网络软件之前需要了解的基础网络知识。

1.  **第一章：网络系统概述**介绍了计算机网络组织模型，以及带宽、延迟、网络层和数据封装的概念。

1.  **第二章：资源定位与流量路由**教你如何通过人类可读的名称识别网络资源，设备如何通过地址定位网络资源，以及流量如何在网络节点之间路由。

**本书的第二部分将帮助你将新学到的网络知识付诸实践，并教你如何编写使用 TCP、UDP 和 Unix 套接字进行通信的程序。这些协议允许不同的设备通过网络交换数据，并且是你将遇到或编写的大多数网络软件的基础。**

1.  **第三章：可靠的 TCP 数据流**深入探讨了传输控制协议（TCP）的握手过程、数据包序列号、确认、重传以及其他确保可靠数据传输的特性。你将使用 Go 来建立并通过 TCP 会话进行通信。

1.  **第四章：发送 TCP 数据**详细介绍了几种通过 TCP 在网络上传输数据的编程技术，包括数据代理、网络流量监控以及避免常见的连接处理错误。

1.  **第五章：不可靠的 UDP 通信**介绍了用户数据报协议（UDP），并将其与 TCP 进行对比。你将了解这两者之间的差异如何影响你的代码，以及在网络应用中何时使用 UDP。你将编写代码，与使用 UDP 的服务交换数据。

1.  **第六章：确保 UDP 可靠性**通过一个实践示例，演示如何使用 UDP 在网络上传输可靠的数据。

1.  **第七章：Unix 域套接字** 向您展示了如何通过基于文件的通信，在同一节点上高效地交换网络服务之间的数据。  

本书的第三部分介绍了应用层协议，如 HTTP 和 HTTP/2。您将学习如何使用 TLS 安全地与服务器、客户端和 API 进行网络交互。  

1.  **第八章：编写 HTTP 客户端** 使用 Go 的优秀 HTTP 客户端发送请求并从服务器接收资源，进行万维网交互。  

1.  **第九章：构建 HTTP 服务** 演示了如何使用处理程序、中间件和复用器，用极少的代码构建功能强大的基于 HTTP 的应用程序。  

1.  **第十章：Caddy：一款现代 Web 服务器** 介绍了一个名为 Caddy 的现代 Web 服务器，它通过模块和配置适配器提供安全性、性能和可扩展性。  

1.  **第十一章：使用 TLS 保障通信安全** 提供了将身份验证和加密集成到应用程序中的工具，包括客户端与服务器之间的相互身份验证。

第四部分展示了如何将数据序列化为适合网络交换的格式；深入了解您的服务；并将代码部署到亚马逊 Web Services、谷歌云和微软 Azure。  

1.  **第十二章：数据序列化** 讨论了如何在使用不同平台和语言的应用程序之间交换数据。您将编写程序，使用 Gob、JSON 和协议缓冲区进行数据序列化和反序列化，并使用 gRPC 进行通信。  

1.  **第十三章：日志记录与度量** 介绍了提供服务运行状况洞察的工具，使您能够主动解决潜在问题并从故障中恢复。  

1.  **第十四章：迁移到云端** 讨论了如何在亚马逊 Web Services、谷歌云和微软 Azure 上开发和部署无服务器应用程序。  
