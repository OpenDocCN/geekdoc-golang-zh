- en: Practical Networking Patterns in Go¶
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: Go中的实用网络模式[¶]
- en: 原文：[https://goperf.dev/02-networking/](https://goperf.dev/02-networking/)
  id: totrans-1
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 原文：[https://goperf.dev/02-networking/](https://goperf.dev/02-networking/)
- en: A 13-part guide to building scalable, efficient, and resilient networked applications
    in Go—grounded in real-world benchmarks, low-level optimizations, and practical
    design patterns.
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: 一份13部分指南，介绍如何在Go中构建可扩展、高效和弹性的网络应用程序——基于实际基准测试、底层优化和实用设计模式。
- en: '* * *'
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: '* * *'
- en: Benchmarking First[¶](#benchmarking-first "Permanent link")
  id: totrans-4
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 基准测试优先[¶](#benchmarking-first "永久链接")
- en: '[Benchmarking and Load Testing for Networked Go Apps](bench-and-load/)'
  id: totrans-5
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[网络Go应用的基准测试和负载测试](bench-and-load/)'
- en: Establish performance baselines before optimizing anything. Learn how to simulate
    realistic traffic using tools like `vegeta`, `wrk`, and `k6`. Covers throughput,
    latency percentiles, connection concurrency, and profiling under load. Sets the
    foundation for diagnosing bottlenecks and measuring the impact of every optimization
    in the series.
  id: totrans-6
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 在优化任何内容之前建立性能基线。学习如何使用 `vegeta`、`wrk` 和 `k6` 等工具模拟真实流量。涵盖吞吐量、延迟百分位数、连接并发性和负载下的分析。为诊断瓶颈和衡量系列中每个优化的影响奠定基础。
- en: '* * *'
  id: totrans-7
  prefs: []
  type: TYPE_NORMAL
  zh: '* * *'
- en: Foundations and Core Concepts[¶](#foundations-and-core-concepts "Permanent link")
  id: totrans-8
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 基础和核心概念[¶](#foundations-and-core-concepts "永久链接")
- en: '[How Go Handles Networking: Concurrency, Goroutines, and the net Package](networking-internals/)'
  id: totrans-9
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[Go如何处理网络：并发、goroutines 和 net 包](networking-internals/)'
- en: Understand Go’s approach to networking from the ground up. Covers how goroutines,
    the `net` package, and the runtime scheduler interact, including blocking I/O
    behavior, connection handling, and the use of pollers like `epoll` or `kqueue`
    under the hood.
  id: totrans-10
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 从底层了解Go的网络方法。涵盖goroutines、`net`包和运行时调度器的交互，包括阻塞I/O行为、连接处理以及底层的 `epoll` 或 `kqueue`
    等轮询器的使用。
- en: '[Efficient Use of `net/http`, `net.Conn`, and UDP](efficient-net-use/)'
  id: totrans-11
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[高效使用 `net/http`, `net.Conn` 和 UDP](efficient-net-use/)'
- en: Compare idiomatic and advanced usage of `net/http` vs raw `net.Conn`. Dive into
    connection pooling, custom dialers, stream reuse, and buffer tuning. Demonstrates
    how to avoid common pitfalls like leaking connections, blocking handlers, or over-allocating
    buffers.
  id: totrans-12
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 比较 `net/http` 与原始 `net.Conn` 的惯用和高级用法。深入了解连接池、自定义拨号器、流重用和缓冲区调整。演示如何避免常见的陷阱，如泄漏连接、阻塞处理程序或过度分配缓冲区。
- en: '* * *'
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: '* * *'
- en: Scaling and Performance Engineering[¶](#scaling-and-performance-engineering
    "Permanent link")
  id: totrans-14
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 扩展和性能工程[¶](#scaling-and-performance-engineering "永久链接")
- en: '[Managing 10K++ Concurrent Connections in Go](10k-connections/)'
  id: totrans-15
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[在Go中管理10K++并发连接](10k-connections/)'
- en: Handling massive concurrency requires intentional architecture. Explore how
    to efficiently serve 10,000+ concurrent sockets using Go’s goroutines, proper
    resource capping, socket tuning, and runtime configuration. Focuses on connection
    lifecycles, scaling pitfalls, and real-world tuning.
  id: totrans-16
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 处理大量并发需要有意向的架构。探索如何使用Go的goroutines、适当的资源限制、套接字调整和运行时配置高效地服务10,000+并发套接字。重点关注连接生命周期、扩展陷阱和实际调整。
- en: '[GOMAXPROCS, epoll/kqueue, and Scheduler-Level Tuning](a-bit-more-tuning/)'
  id: totrans-17
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[GOMAXPROCS, epoll/kqueue 和调度器级别调整](a-bit-more-tuning/)'
- en: Dive into low-level performance knobs like `GOMAXPROCS`, `GODEBUG`, thread pinning,
    and how Go’s scheduler interacts with epoll/kqueue. Learn when increasing parallelism
    helps—and when it doesn’t. Includes tools for CPU affinity and benchmarking the
    effect of these changes.
  id: totrans-18
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 深入了解低级性能旋钮，如 `GOMAXPROCS`、`GODEBUG`、线程绑定以及Go的调度器如何与epoll/kqueue交互。了解何时增加并行性有帮助——何时没有。包括用于CPU亲和力和基准测试这些更改影响的工具。
- en: '* * *'
  id: totrans-19
  prefs: []
  type: TYPE_NORMAL
  zh: '* * *'
- en: Diagnostics and Resilience[¶](#diagnostics-and-resilience "Permanent link")
  id: totrans-20
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 诊断和弹性[¶](#diagnostics-and-resilience "永久链接")
- en: '[Building Resilient Connection Handling with Load Shedding and Backpressure](resilient-connection-handling/)'
  id: totrans-21
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[使用负载卸载和背压构建弹性连接处理](resilient-connection-handling/)'
- en: Learn how to prevent overloads from crashing your system. Covers circuit breakers,
    passive vs active load shedding, backpressure strategies using channel buffering
    and timeouts, and how to reject or degrade requests gracefully under pressure.
  id: totrans-22
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 学习如何防止过载导致系统崩溃。涵盖断路器、被动与主动负载卸载、使用通道缓冲和超时的时间背压策略，以及在压力下优雅地拒绝或降级请求。
- en: '[Memory Management and Leak Prevention in Long-Lived Connections](long-lived-connections/)'
  id: totrans-23
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[长时间连接中的内存管理和泄漏预防](long-lived-connections/)'
- en: Long-lived connections like WebSockets or TCP streams can slowly leak memory
    or accumulate goroutines. This post shows how to identify common leaks, enforce
    read/write deadlines, manage backpressure, and trace heap growth with memory profiles.
  id: totrans-24
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 长期连接，如WebSockets或TCP流，可能会缓慢泄漏内存或积累goroutines。本文展示了如何识别常见的泄漏、强制执行读写截止日期、管理背压，并使用内存配置文件追踪堆增长。
- en: '* * *'
  id: totrans-25
  prefs: []
  type: TYPE_NORMAL
  zh: '* * *'
- en: Transport-Level Optimization[¶](#transport-level-optimization "Permanent link")
  id: totrans-26
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 传输层优化[¶](#transport-level-optimization "永久链接")
- en: '[Comparing TCP, HTTP/2, and gRPC Performance in Go](tcp-http2-grpc/)'
  id: totrans-27
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[在Go中比较TCP、HTTP/2和gRPC性能](tcp-http2-grpc/)'
- en: 'Benchmark and analyze different transport protocols in Go: raw TCP with custom
    framing, HTTP/2 via `net/http`, and gRPC. Evaluate latency, throughput, connection
    reuse, and CPU/memory cost across real scenarios like internal APIs, messaging
    systems, and microservices.'
  id: totrans-28
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 在Go中基准测试和分析不同的传输协议：原始TCP带有自定义帧，通过`net/http`的HTTP/2，以及gRPC。评估真实场景（如内部API、消息系统和微服务）中的延迟、吞吐量、连接重用和CPU/内存成本。
- en: '[QUIC in Go: Building Low-Latency Services with quic-go](quic-in-go/)'
  id: totrans-29
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[Go中的QUIC：使用quic-go构建低延迟服务](quic-in-go/)'
- en: Explore QUIC as a next-gen transport for real-time and mobile-first systems.
    Introduce the `quic-go` library, demonstrate setup for secure multiplexed streams,
    and compare performance against HTTP/2 and TCP. Also covers connection migration
    and 0-RTT for fast startup.
  id: totrans-30
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 探索QUIC作为实时和以移动优先系统的下一代传输。介绍`quic-go`库，演示安全多路复用流的设置，并与HTTP/2和TCP比较性能。还涵盖连接迁移和0-RTT以实现快速启动。
- en: '* * *'
  id: totrans-31
  prefs: []
  type: TYPE_NORMAL
  zh: '* * *'
- en: Low-Level and Advanced Tuning[¶](#low-level-and-advanced-tuning "Permanent link")
  id: totrans-32
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 低级和高级调整[¶](#low-level-and-advanced-tuning "永久链接")
- en: '[Low-Level Network Optimizations: Socket Options That Matter](low-level-optimizations/)'
  id: totrans-33
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[低级网络优化：重要的套接字选项](low-level-optimizations/)'
- en: Explore advanced socket-level tuning options like disabling Nagle’s algorithm
    (`TCP_NODELAY`), adjusting `SO_REUSEPORT`, `SO_RCVBUF`/`SO_SNDBUF`, TCP keepalives,
    and connection backlog (`SOMAXCONN`). Explain how Go exposes these via `syscall`
    and how to wrap them safely. Real-world examples included for latency-sensitive
    systems and high-throughput services.
  id: totrans-34
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 探索高级套接字级别调整选项，如禁用Nagle算法（`TCP_NODELAY`）、调整`SO_REUSEPORT`、`SO_RCVBUF`/`SO_SNDBUF`、TCP保活和连接队列（`SOMAXCONN`）。解释Go如何通过`syscall`暴露这些选项，以及如何安全地包装它们。包括针对延迟敏感系统和高吞吐量服务的真实世界示例。
- en: '[Tuning DNS Performance in Go Services](dns_performance/)'
  id: totrans-35
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[在Go服务中调整DNS性能](dns_performance/)'
- en: DNS lookups are often overlooked as latency culprits. Learn how Go performs
    name resolution (cgo vs Go resolver), when to cache results, and how to use custom
    dialers or pre-resolved IPs to avoid flaky network paths. Includes metrics and
    debugging tips for real-world DNS slowdowns.
  id: totrans-36
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: DNS查找通常被忽视，作为延迟的罪魁祸首。学习Go如何执行名称解析（cgo与Go解析器），何时缓存结果，以及如何使用自定义拨号器或预解析的IP来避免不可靠的网络路径。包括针对真实世界DNS缓慢的指标和调试技巧。
- en: '[Optimizing TLS for Speed: Handshake, Reuse, and Cipher Choice](tls-for-speed/)'
  id: totrans-37
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[优化TLS以提高速度：握手、重用和加密选择](tls-for-speed/)'
- en: 'TLS adds security—but it can also add overhead. Tune your Go service for fast
    and secure TLS: enable session resumption, choose fast cipher suites, use ALPN
    negotiation wisely, and minimize cert verification cost. Examples included with
    `tls.Config` best practices.'
  id: totrans-38
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: TLS增加了安全性，但它也可能增加开销。调整您的Go服务以实现快速安全的TLS：启用会话恢复、选择快速加密套件、明智地使用ALPN协商，并最小化证书验证成本。包括使用`tls.Config`最佳实践的示例。
- en: '[Connection Lifecycle Observability: From Dial to Close](connection_observability/)'
  id: totrans-39
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[连接生命周期可观察性：从拨号到关闭](connection_observability/)'
- en: Trace the full lifecycle of a connection with visibility at each stage—DNS,
    dial, handshake, negotiation, reads/writes, and teardown. Learn how to log connection
    spans, trace hangs, correlate errors with performance metrics, and build custom
    observability into network flows.
  id: totrans-40
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 跟踪连接的完整生命周期，并在每个阶段（DNS、拨号、握手、协商、读写和断开连接）保持可见性。学习如何记录连接跨度、追踪挂起、将错误与性能指标关联起来，并将自定义可观察性构建到网络流中。
