["```go\npackage main\n\n// pprof-start\nimport (\n// pprof-end\n    \"flag\"\n    \"fmt\"\n    \"log\"\n    \"math/rand/v2\"\n    \"net/http\"\n// pprof-start\n    _ \"net/http/pprof\"\n// pprof-end\n    \"os\"\n    \"os/signal\"\n    \"time\"\n// pprof-start\n)\n// pprof-end\n\nvar (\n    fastDelay   = flag.Duration(\"fast-delay\", 0, \"Fixed delay for fast handler (if any)\")\n    slowMin     = flag.Duration(\"slow-min\", 1*time.Millisecond, \"Minimum delay for slow handler\")\n    slowMax     = flag.Duration(\"slow-max\", 300*time.Millisecond, \"Maximum delay for slow handler\")\n    gcMinAlloc  = flag.Int(\"gc-min-alloc\", 50, \"Minimum number of allocations in GC heavy handler\")\n    gcMaxAlloc  = flag.Int(\"gc-max-alloc\", 1000, \"Maximum number of allocations in GC heavy handler\")\n)\n\nfunc randRange(min, max int) int {\n    return rand.IntN(max-min) + min\n}\n\nfunc fastHandler(w http.ResponseWriter, r *http.Request) {\n    if *fastDelay > 0 {\n        time.Sleep(*fastDelay)\n    }\n    fmt.Fprintln(w, \"fast response\")\n}\n\nfunc slowHandler(w http.ResponseWriter, r *http.Request) {\n    delayRange := int((*slowMax - *slowMin) / time.Millisecond)\n    delay := time.Duration(randRange(1, delayRange)) * time.Millisecond\n    time.Sleep(delay)\n    fmt.Fprintf(w, \"slow response with delay %d ms\\n\", delay.Milliseconds())\n}\n\n// heavy-start\nvar longLivedData [][]byte\n\nfunc gcHeavyHandler(w http.ResponseWriter, r *http.Request) {\n    numAllocs := randRange(*gcMinAlloc, *gcMaxAlloc)\n    var data [][]byte\n    for i := 0; i < numAllocs; i++ {\n        // Allocate 10KB slices. Occasionally retain a reference to simulate long-lived objects.\n        b := make([]byte, 1024*10)\n        data = append(data, b)\n        if i%100 == 0 { // every 100 allocations, keep the data alive\n            longLivedData = append(longLivedData, b)\n        }\n    }\n    fmt.Fprintf(w, \"allocated %d KB\\n\", len(data)*10)\n}\n// heavy-end\n\nfunc main() {\n    flag.Parse()\n\n    http.HandleFunc(\"/fast\", fastHandler)\n    http.HandleFunc(\"/slow\", slowHandler)\n    http.HandleFunc(\"/gc\", gcHeavyHandler)\n\n// pprof-start\n// ...\n\n    // Start pprof in a separate goroutine.\n    go func() {\n        log.Println(\"pprof listening on :6060\")\n        if err := http.ListenAndServe(\"localhost:6060\", nil); err != nil {\n            log.Fatalf(\"pprof server error: %v\", err)\n        }\n    }()\n// pprof-end\n\n    // Create a server to allow for graceful shutdown.\n    server := &http.Server{Addr: \":8080\"}\n\n    go func() {\n        log.Println(\"HTTP server listening on :8080\")\n        if err := server.ListenAndServe(); err != nil && err != http.ErrServerClosed {\n            log.Fatalf(\"HTTP server error: %v\", err)\n        }\n    }()\n\n    // Graceful shutdown on interrupt signal.\n    sigCh := make(chan os.Signal, 1)\n    signal.Notify(sigCh, os.Interrupt)\n    <-sigCh\n    log.Println(\"Shutting down server...\")\n    if err := server.Shutdown(nil); err != nil {\n        log.Fatalf(\"Server Shutdown Failed:%+v\", err)\n    }\n    log.Println(\"Server exited\")\n} \n```", "```go\ngo run main.go \n```", "```go\ngo install github.com/tsenart/vegeta@latest \n```", "```go\necho \"GET http://localhost:8080/slow\" > targets.txt \n```", "```go\nvegeta attack -rate=100 -duration=30s -targets=targets.txt | tee results.bin | vegeta report \n```", "```go\n> vegeta attack -rate=100 -duration=30s -targets=targets.txt | tee results.bin | vegeta report\nRequests      [total, rate, throughput]  3000, 100.04, 100.03\nDuration      [total, attack, wait]      29.989635542s, 29.989108333s, 527.209µs\nLatencies     [mean, 50, 95, 99, max]    524.563µs, 504.802µs, 793.997µs, 1.47362ms, 7.351541ms\nBytes In      [total, mean]              42000, 14.00\nBytes Out     [total, mean]              0, 0.00\nSuccess       [ratio]                    100.00%\nStatus Codes  [code:count]               200:3000\nError Set: \n```", "```go\nvegeta report -type='hist[0,10ms,50ms,100ms,200ms,500ms,1s]' < results.bin \n```", "```go\nvegeta plot < results.bin > plot.html \n```", "```go\ncat > targets.txt <<EOF\nGET http://localhost:8080/fast\nGET http://localhost:8080/slow\nEOF \n```", "```go\nvegeta attack -rate=50 -duration=30s -targets=targets.txt | tee mixed-results.bin | vegeta report -type='hist[0,50ms,100ms,200ms,500ms,1s,2s]' \n```", "```go\n# Send 80% of requests to /fast\nvegeta attack -rate=40 -duration=30s -targets=<(echo \"GET http://localhost:8080/fast\") > fast.bin &\n\n# Send 20% of requests to /slow\nvegeta attack -rate=10 -duration=30s -targets=<(echo \"GET http://localhost:8080/slow\") > slow.bin &\n\nwait \n```", "```go\nvegeta encode fast.bin slow.bin > combined.bin\nvegeta report -type='hist[0,50ms,100ms,200ms,500ms,1s,2s]' < combined.bin \n```", "```go\nbrew install wrk  # or build from source \n```", "```go\nwrk -t4 -c100 -d30s http://localhost:8080/fast \n```", "```go\n> wrk -t4 -c100 -d30s http://localhost:8080/fast\nRunning 30s test @ http://localhost:8080/fast\n  4 threads and 100 connections\n  Thread Stats   Avg      Stdev     Max   +/- Stdev\n    Latency     1.29ms  255.31us   5.24ms   84.86%\n    Req/Sec    19.30k   565.16    21.93k    77.92%\n  2304779 requests in 30.00s, 287.94MB read\nRequests/sec:  76823.88\nTransfer/sec:      9.60MB \n```", "```go\nbrew install k6 \n```", "```go\n// script.js\nimport http from 'k6/http';\nimport { sleep } from 'k6';\n\nexport const options = {\n  stages: [\n    { duration: '10s', target: 50 },\n    { duration: '30s', target: 50 },\n    { duration: '10s', target: 0 },\n  ],\n};\n\nexport default function () {\n  http.get('http://localhost:8080/fast');\n  sleep(1);\n} \n```", "```go\nk6 run script.js \n```", "```go\n> k6 run script.js\n\n         /\\      Grafana   /‾‾/\n    /\\  /  \\     |\\  __   /  /\n   /  \\/    \\    | |/ /  /   ‾‾\\\n  /          \\   |   (  |  (‾)  |\n / __________ \\  |_|\\_\\  \\_____/\n\n     execution: local\n        script: script.js\n        output: -\n\n     scenarios: (100.00%) 1 scenario, 50 max VUs, 1m20s max duration (incl. graceful stop):\n              * default: Up to 50 looping VUs for 50s over 3 stages (gracefulRampDown: 30s, gracefulStop: 30s)\n\n  █ TOTAL RESULTS\n\n    HTTP\n    http_req_duration.......................................................: avg=495.55µs min=116µs med=449µs max=5.49ms p(90)=705µs p(95)=820.39µs\n      { expected_response:true }............................................: avg=495.55µs min=116µs med=449µs max=5.49ms p(90)=705µs p(95)=820.39µs\n    http_req_failed.........................................................: 0.00%  0 out of 2027\n    http_reqs...............................................................: 2027   40.146806/s\n\n    EXECUTION\n    iteration_duration......................................................: avg=1s       min=1s    med=1s    max=1.01s  p(90)=1s    p(95)=1s\n    iterations..............................................................: 2027   40.146806/s\n    vus.....................................................................: 3      min=3         max=50\n    vus_max.................................................................: 50     min=50        max=50\n\n    NETWORK\n    data_received...........................................................: 266 kB 5.3 kB/s\n    data_sent...............................................................: 176 kB 3.5 kB/s\n\nrunning (0m50.5s), 00/50 VUs, 2027 complete and 0 interrupted iterations\ndefault ✓ [======================================] 00/50 VUs  50s \n```", "```go\nimport (\n\n    _ \"net/http/pprof\"\n\n)\n\n// ...\n\n    // Start pprof in a separate goroutine.\n    go func() {\n        log.Println(\"pprof listening on :6060\")\n        if err := http.ListenAndServe(\"localhost:6060\", nil); err != nil {\n            log.Fatalf(\"pprof server error: %v\", err)\n        }\n    }() \n```", "```go\ngo tool pprof http://localhost:6060/debug/pprof/profile?seconds=30 \n```", "```go\ngo tool pprof -http=:7070 cpu.prof #(1) \n```", "```go\ngo tool pprof http://localhost:6060/debug/pprof/heap \n```", "```go\ngo tool pprof -http=:7070 mem.prof #(1) \n```"]